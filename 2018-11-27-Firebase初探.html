
<div id="app" class="">
  <div class="" v-if="authUser">
    <div class="">
      <div> {{authUser.email}} 已登陆</div>
      <img :src="authUser.photoURL" height="150" alt="">
      <div>你好 {{authUser.displayName || 'friend'}}</div>
      <button type="button" name="button" @click="logout">退出</button>
    </div>
  </div>
  <div v-else class="">

    <form class="unminimized-comment editable-comment comment current-user previewable-edit js-comment js-task-list-container timeline-comment reorderable-task-lists "  method="post" @submit.prevent="register">
      <div class="clearfix timeline-comment-header">
        <h3 class="f5 text-normal timeline-comment-header-text">
          注册
        </h3>
      </div>
      <div class="comment-body">
        <input class="form-control form-control subnav-search-input input-contrast" type="text" v-model="email" name="" value="" placeholder="账号">
        <input class="form-control form-control subnav-search-input input-contrast" type="password" v-model="password" name="" value="" placeholder="密码">
        <button class="btn "   type="button" name="button" @click="register">注册</button>
      </div>
    </form>
    <form class="unminimized-comment editable-comment comment current-user previewable-edit js-comment js-task-list-container timeline-comment reorderable-task-lists "   method="post" @submit.prevent="register">
      <div class="clearfix timeline-comment-header">
        <h3 class="f5 text-normal timeline-comment-header-text">
          登陆
        </h3>
      </div>
      <div class="comment-body">
        <input class="form-control form-control subnav-search-input input-contrast" type="text" v-model="email" name="" value="" placeholder="账号">
        <input class="form-control form-control subnav-search-input input-contrast" type="password" v-model="password" name="" value="" placeholder="密码">
        <button class="btn " type="button" name="button" @click="login">登陆</button>
      </div>
    </form>
    <div class="">
      <button class="btn  "  type="button" name="button" @click="loginWithGithub">使用Github快捷登陆</button>
      <button class="btn  "  type="button" name="button" @click="loginWithGithub">使用Github快捷登陆</button>
    </div>
  </div>
</div>

<script src="firebase.5.5.9.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyBU7btLIY06LtJonuBCJM1vG0NgE4PDWCo",
    authDomain: "github-4bd82.firebaseapp.com",
    databaseURL: "https://github-4bd82.firebaseio.com",
    projectId: "github-4bd82",
    storageBucket: "github-4bd82.appspot.com",
    messagingSenderId: "481207879273"
  };
  firebase.initializeApp(config);
</script>

<link rel="stylesheet" href="https://unpkg.com/native-toast@2.0.0/dist/native-toast.css">
<script src="https://unpkg.com/native-toast@2.0.0/dist/native-toast.min.js" charset="utf-8"></script>
<script src="vue.js"></script>
<script>
  new Vue({
    el:'#app',
    data:{
      email:'',
      password:'',
      authUser:null,
    },
    methods:{
      alert(message){
        nativeToast({
          message,
          position: 'north',
          // Self destroy in 5 seconds
          timeout: 5000,
          // type: 'warning'
        })
      },
      register(){
        firebase.auth().createUserWithEmailAndPassword(this.email,this.password)
        .catch(error=> this.alert(error.message));
      },
      login(){
        firebase.auth().signInWithEmailAndPassword(this.email,this.password)
        .catch(error=> this.alert(error.message));
      },
      loginWithGithub(){
        const provider = new firebase.auth.GithubAuthProvider();
        firebase.auth().signInWithPopup(provider)
        .catch(error=> this.alert(error.message))
        .then(data=>console.log(data.user,data.credential.accessToken))
      },
      logout(){
        firebase.auth().signOut()
      },
    },
    created(){
      firebase.auth().onAuthStateChanged(user=>{
        this.authUser=user;
      })
    }
  })


</script>
